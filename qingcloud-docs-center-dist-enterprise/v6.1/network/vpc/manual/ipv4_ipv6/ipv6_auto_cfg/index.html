




<!DOCTYPE html>
<html lang="zh"><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">

<meta name="keywords" content="云计算,青云,QingCloud,文档">


<meta name="description" content="这里是企业云文档页面">

<link rel="icon" href="https://console.petaexpress.com/assets/cdn/hinata/0a234310-78f9-4323-8d59-2b36ac15120a-favicon.ico" type="image/x-icon">

<title>开启云服务器 IPv6 自动化配置 - 用户指南</title>
<link href="/css/bulma.css" rel="stylesheet">
<link href="/css/bulma-tooltip.min.css" rel="stylesheet">
<link href="/css/atom-one-light.css" rel="stylesheet" />
<link href="/css/magnific-popup.css" rel="stylesheet" />


<link href="/scss/main.min.e407fb236ca21333e8c63516ab2f144dd2cdbdaf2eca08e58895ff89ce74abc3.css" rel="stylesheet" integrity="sha256-5Af7I2yiEzPoxjUWqy8UTdLNva8uygjliJX/ic50q8M=">

<script src="/js/jquery-2.2.4.js"></script>
<body
        class="root   "
        style=""
        ><header>
  <nav class="navbar">
    
      <a href="/" class="navbar-logo-wrapper">
        <img class="navbar-logo" src="https://console.petaexpress.com/assets/cdn/hinata/ba65c1e6-b7a4-4085-b0e2-23104d8e71e1-logo_en.svg" />
        <div class="navbar-split navbar-left-split">|</div>
        <div class="navbar-logo-text">企业云</div>
      </a>
    
    <div class="navbar-nav">
      <div
        class="navbar-nav-item navbar-nav-version "
        style="display:none;">
        
        <div class="dropdown-trigger">
          <span class="project-version">
            v6.1
          </span>
          
        </div>
        
      </div>
      
    </div>
    <div class="search navbar-search">
      <form action="/v6.1/search/" method="GET">
        <div class="control has-icons-left has-icons-right docs-search-input">
          <span class="icon is-left">
            <img src="/images/icons/magnifier_duotone.svg" />
          </span>
          <input
            class="input"
            name="q"
            type="input"
            placeholder="请输入关键字快速获取帮助"
            autocomplete="off"
          />
          <span class="icon is-right"> </span>
        </div>
        <img class="clear-search-input" src="/images/icons/close_duotone.svg" />
      </form>
      <div class="search-result navbar-search-result">
        <div class="search-result-loading"></div>
        <div class="search-result-content"></div>
        <div class="search-result-none">
          没有找到搜索结果， 请更换关键词重新搜索
        </div>
      </div>
    </div>
    
      
      
        
          <a class="navbar-item-right btn primary-btn navbar-btn "
            target="_blank"
            data-url="https://console.petaexpress.com"
            data-text="控制台"
            href="https://console.petaexpress.com">
            控制台
          </a>
        
      
    
  </nav>
</header><script id="search-result-total-template" type="text/x-js-template">
  <div class="search-result-total">
    共为您找到 ${count} 个结果
  </div>
</script>

<script id="search-result-item-template" type="text/x-js-template">
  <div class="search-result-content-item">
    <div class="search-result-content-item-title">
      <a href="${href}">${title}</a>
    </div>
    <div class="search-result-content-item-content">
      ${content}
    </div>
    <div class="search-result-content-item-ref">
      <ul class="content-breadcrumb">
      </ul>
    </div>
  </div>
</div>
</script>

<script id="search-breadcrumb-template" type="text/x-js-template">
  <li class="icon-slash_fill">
    <a href="${href}">${title}</a>
  </li>
</script>

<script id="search-result-total-template" type="text/x-js-template">
  <div class="search-result-total">
    共为您找到 ${count} 个结果
  </div>
</script>
<script id="search-result-page-template" type="text/x-js-template">
  <nav class="search-result-pagination pagination is-centered">
    <a class="pagination-previous icon-chevron_left_fill"></a>
    <a class="pagination-next icon-chevron_right_fill"></a>
    <ul class="pagination-list">
    </ul>
  </nav>
</script>
<div class="container">

  


  
    
  


<aside class="sidebar-wrapper">
  <div class="sidebar-drag"></div>
  <div class="sidebar">
    
      <div class="sidebar-title" >
        <a href="/v6.1/network/vpc/">
          
            VPC 网络
        </a>
        
          <span class="icon-menu_fill"></span>
        
      </div>
      
        <div class="search-sidebar-wrapper">
          
<div class="search search-sidebar">
  <div class="control has-icons-left has-icons-right docs-search-input">
    <span class="icon is-left">
      <img src="/images/icons/magnifier_duotone.svg" />
    </span>
    <input class="input" name="q" type="input" placeholder="请输入关键字快速获取帮助" autocomplete="off" />
    <span class="icon is-right"> </span>
  </div>
  <img class="clear-search-input" src="/images/icons/close_duotone.svg" />
</div>
<div class="search-sidebar-result columns">
  
    <div class="column">
      
        
          <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-computing_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">计算</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/compute/vm/">
      云服务器
    </a>
    
    <a href="/v6.1/compute/hpc/">
      弹性高性能计算 EHPC
    </a>
    
    <a href="/v6.1/compute/image/">
      镜像
    </a>
    
    <a href="/v6.1/compute/ssh/">
      SSH 密钥
    </a>
    
    <a href="/v6.1/compute/instance_group/">
      安置策略组
    </a>
    
    <a href="/v6.1/compute/migration/">
      跨区域迁移
    </a>
    
  </div>
</div>
        
      
        
      
        
      
        
      
        
          <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-database_cache_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">数据库</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/database/mysql/">
      关系型数据库 MySQL Plus
    </a>
    
    <a href="/v6.1/database/postgresql/">
      关系型数据库 PostgreSQL
    </a>
    
    <a href="/v6.1/database/radondb/">
      分布式数据库 RadonDB
    </a>
    
    <a href="/v6.1/database/polondb/">
      分布式数据库 PolonDB
    </a>
    
    <a href="/v6.1/database/chronusdb/">
      时序数据库 ChronusDB
    </a>
    
    <a href="/v6.1/database/mongodb/">
      文档数据库 MongoDB
    </a>
    
    <a href="/v6.1/database/mongodb_cluster/">
      文档数据库 MongoDB Cluster
    </a>
    
    <a href="/v6.1/database/redis_standalone/">
      键值数据库 Redis Standalone
    </a>
    
    <a href="/v6.1/database/redis_cluster/">
      键值数据库 Redis Cluster
    </a>
    
  </div>
</div>
        
      
        
      
        
      
        
      
        
          <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-container_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">容器</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/container/qke_plus/">
      容器引擎 QKE
    </a>
    
    <a href="/v6.1/container/harbor/">
      Harbor 镜像仓库
    </a>
    
  </div>
</div>
        
      
        
      
        
      
        
      
        
          <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-operation_manage_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">运维与管理</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/operation/migration/">
      服务器迁移中心
    </a>
    
    <a href="/v6.1/operation/topology/">
      资源编排
    </a>
    
    <a href="/v6.1/operation/resource/">
      资源管理
    </a>
    
    <a href="/v6.1/operation/autoscaling/">
      自动伸缩
    </a>
    
    <a href="/v6.1/operation/tools/">
      运维工具
    </a>
    
    <a href="/v6.1/operation/vmware/">
      VMware 纳管
    </a>
    
  </div>
</div>
        
      
        
      
    </div>
    <div class="column">
      
      
      
      
      <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-storage_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">存储</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/storage/disk/">
      硬盘
    </a>
    
    <a href="/v6.1/storage/backup/">
      备份
    </a>
    
    <a href="/v6.1/storage/object_storage/">
      对象存储
    </a>
    
    <a href="/v6.1/storage/epfs/">
      文件存储 EPFS
    </a>
    
    <a href="/v6.1/storage/vnas/">
      文件存储 vNAS
    </a>
    
    <a href="/v6.1/storage/qfs/">
      文件存储 QFS
    </a>
    
  </div>
</div>
      
      
      
      
      
      
      
      
      
      <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-mq_middleware_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">消息队列与中间件</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/middware/kafka/">
      Kafka 服务
    </a>
    
    <a href="/v6.1/middware/rabbitmq/">
      RabbitMQ 服务
    </a>
    
    <a href="/v6.1/middware/etcd/">
      Etcd 服务
    </a>
    
    <a href="/v6.1/middware/api_gateway/">
      API 网关
    </a>
    
  </div>
</div>
      
      
      
      
      
      
      
      
      
      <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-shield_key_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">安全</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/security/firewall/">
      云防火墙 CFW
    </a>
    
    <a href="/v6.1/security/srp/">
      安全资源池
    </a>
    
    <a href="/v6.1/security/hss/">
      主机安全
    </a>
    
  </div>
</div>
      
      
      
      
      
      
      
      
      
      <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-data_warehouse_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">用户服务</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/services/bill_center/">
      费用中心
    </a>
    
    <a href="/v6.1/services/notification-center/">
      消息中心
    </a>
    
    <a href="/v6.1/services/vdc/">
      企业管理
    </a>
    
  </div>
</div>
      
      
    </div>
    <div class="column">
      
      
      
      
      
      
      <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-nat_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">网络服务</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/network/vpc/">
      VPC 网络
    </a>
    
    <a href="/v6.1/network/nat_gateway/">
      NAT 网关
    </a>
    
    <a href="/v6.1/network/eip/">
      弹性公网 EIP
    </a>
    
    <a href="/v6.1/network/loadbalancer/">
      负载均衡
    </a>
    
    <a href="/v6.1/network/border_router/">
      边界路由器
    </a>
    
    <a href="/v6.1/network/security_group/">
      安全组
    </a>
    
    <a href="/v6.1/network/acl/">
      网络访问控制
    </a>
    
    <a href="/v6.1/network/mcn/">
      流量牵引服务
    </a>
    
  </div>
</div>
      
      
      
      
      
      
      
      
      
      <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-bigdata_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">大数据服务</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/bigdata/elk/">
      ELK 服务
    </a>
    
    <a href="/v6.1/bigdata/opensearch/">
      OpenSearch 服务
    </a>
    
    <a href="/v6.1/bigdata/zookeeper/">
      ZooKeeper 服务
    </a>
    
  </div>
</div>
      
      
      
      
      
      
      
      
      
      <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-monitor_service_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">监控服务</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/monitor_service/cloudsat/">
      云监控 CloudSat
    </a>
    
  </div>
</div>
      
      
      
      
      
      
      
      
    </div>
    <div class="column">
      
      
      
      
      
      
      
      
      <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-apps_5_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">AppCenter</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/appcenter/market/">
      AppCenter 控制台
    </a>
    
    <a href="/v6.1/appcenter/dev-platform/">
      应用开发平台
    </a>
    
  </div>
</div>
      
      
      
      
      
      
      
      
      
      <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-bi_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">数据仓库与 BI</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/dwh_bi/clickhouse/">
      ClickHouse
    </a>
    
  </div>
</div>
      
      
      
      
      
      
      
      
      
      <div class="search-sidebar-result-item">
  <div class="search-sidebar-result-item-title">
    
    <span class="search-sidebar-result-item-title-icon content-item-title-icon icon-human_gear_duotone">
      <span class="path1"></span>
      <span class="path2"></span>
      <span class="path3"></span>
      <span class="path4"></span>
      <span class="path5"></span>
      <span class="path6"></span>
      <span class="path7"></span>
      <span class="path8"></span>
      <span class="path9"></span>
      <span class="path10"></span>
      <span class="path11"></span>
      <span class="path12"></span>
      <span class="path13"></span>
      <span class="path14"></span>
      <span class="path15"></span>
    </span>
    
    <span class="search-sidebar-result-item-title-text">访问与鉴权</span>
  </div>
  <div class="search-sidebar-result-item-children">
    
    <a href="/v6.1/authorization/iam/">
      访问鉴权管理
    </a>
    
    <a href="/v6.1/authorization/account/">
      账户中心
    </a>
    
    <a href="/v6.1/authorization/access_key/">
      API 密钥
    </a>
    
  </div>
</div>
      
      
      
      
      
      
    </div>
  
</div>
        </div>
      
    
    <nav class="sidebar-menu">
      
        
        <ul>
  
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >产品简介</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/intro/10_intro/">什么是 VPC 网络</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/intro/15_advantage/">产品优势</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/intro/16_apply/">应用场景</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/intro/20_function/">产品功能</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/intro/40_concept/">基本概念</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >计费指南</a>
            
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/billing/price/">VPC 网络计费</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >快速入门</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/quick-start/10_qs_net_plan/">网络规划</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/quick-start/20_qs_ipv4/">搭建 IPv4 VPC 网络</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/quick-start/30_qs_ipv6/">搭建 IPv6 VPC 网络</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item active ">
            <a >操作指南</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_up_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >VPC 网络</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpcnet/10_create_vpc/">创建 VPC 网络</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpcnet/15_bind_vxnet/">连接私有网络</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpcnet/20_modify_vpc/">修改 VPC 基本信息</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpcnet/25_mdy_type/">修改 VPC 规格类型</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpcnet/26_bind_eip/">绑定公网 IP</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpcnet/30_fig_manage/">VPC 图形化操作</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpcnet/35_del_vpc/">删除 VPC 网络</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >私有网络</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vxnet/05_create_vxnet/">创建私有网络</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vxnet/08_addto_vpc/">加入 VPC 网络</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vxnet/10_mdfy_vxnet/">修改私有网络基本信息</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vxnet/20_add_resource/">在私有网络中创建资源</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vxnet/25_bind_acl/">绑定网络 ACL</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vxnet/30_bind_route/">绑定路由表</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vxnet/31_leave_vpc/">离开 VPC 网络</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vxnet/32_del_vxnet/">删除私有网络</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item active ">
            <a href="/v6.1/network/vpc/manual/ipv4_ipv6/">IPv4/IPv6 双栈网络</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_up_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/ipv4_ipv6/enable_ipv6/">启用 IPv4/IPv6 双栈网络</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item active current">
            <a href="/v6.1/network/vpc/manual/ipv4_ipv6/ipv6_auto_cfg/">开启云服务器 IPv6 自动化配置</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >路由表</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/routing/01_route_description/">路由表概述</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/routing/02_route_function/">使用路由表</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/routing/03_route_application_vxnet/">为私有网络添加路由规则</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/routing/04_route_application_lb/">为负载均衡器添加路由规则</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >隧道服务</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/tunnel/intro/">隧道服务概述</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/tunnel/mge_tunnel_rule/">管理隧道规则</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/tunnel/gre/">GRE 隧道应用示例</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/tunnel/ipsec/">IPsec 隧道应用示例</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >VPN 服务</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpn/vpn_intro/">VPN 服务概述</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpn/use_openvpn/">使用 OpenVPN</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpn/use_pptp/">使用 PPTP</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpn/use_l2tp/">使用 L2TP</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >内网 IP</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vip/01_vip_description/">内网 IP 概述</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vip/02_use_vpc_vip/">使用 VPC 网络 IP</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vip/03_use_basic_vip/">使用 VBC 网络 IP</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vip/04_vip_bind_vm/">为云服务器配置内网 IP</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >网络流量镜像</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/span/01_span_des/">流量镜像概述</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/span/02_span_mgt/">使用流量镜像</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/manual/vpc_acl/">网关过滤控制</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >最佳实践</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/best-practices/ipsec_star_topology/">搭建星型拓扑 IPsec 隧道</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/best-practices/large_net_across_vpc/">跨 VPC 大规模组网</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/best-practices/building_tunnel_with_strongswan_and_vpc/">strongswan 与 VPC 共同搭建隧道</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/best-practices/how_to_build_gre_tunnel/">在不同可用区搭建 GRE 隧道</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/best-practices/vpc_port_forwards_to_the_host_in_the_non_own_private_network/">通过 VPC 端口转发实现本地提供公网服务</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/best-practices/windows_client_realizes_intranet_interworking_between_multiple_vpcs_after_vpn_is_dialed_in/">Windows 客户端拨入 VPN 实现跨 VPC 内网互通</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/best-practices/vip_keepalived_ha/">使用 VIP 与 Keepalived 配置高可用服务</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
    
      
      
      
      
        
          <li
            class="sidebar-item collapsed ">
            <a >常见问题</a>
            
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
              
                
                  
                
              
            
            
              <span
                class="menu-switch-icon icon-caret_down_fill">
              </span>
            
          </li>
          
          <ul>
  
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/faq/how_to_use_public_network_dns_forwarding/">公网 DNS 转发如何使用</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/faq/vpc_faq/">何种情况下需要手动配置网络</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/faq/network_between_vms/">VPC 中云服务器之间网络不通</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/faq/openvpn_dns_push/">OpenVPN 客户端启用服务端推送的 DNS 配置</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/faq/openvpn_add_virtual_network_adapter/">OpenVPN 添加虚拟网卡</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/faq/methods_of_port_forwarding/">使用端口转发功能</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/faq/intranet_dns_guide/">使用内网 DNS 功能</a>
          </li>
        
      
    
  
    
      
      
      
      
          
          <li class="sidebar-item  ">
            <a href="/v6.1/network/vpc/faq/ptr/">开启/关闭 PTR 记录</a>
          </li>
        
      
    
  
</ul>
        
      
    
  
</ul>
      
    </nav>

  </div>
</aside>
<div class="content-card-wrapper">
  <div class="content-card">
    <div class="content-wrapper"><ul class="content-breadcrumb">
      <li class="icon-slash_fill"><a href="/v6.1" data-url="/v6.1">用户指南</a></li>
      <li class="icon-slash_fill"><a href="/v6.1/network/vpc" data-url="/v6.1/network/vpc">VPC 网络</a></li>
        
        <li class="icon-slash_fill"><a href="/v6.1/network/vpc/manual/vpcnet/10_create_vpc/" data-url="/v6.1/network/vpc/manual">操作指南</a></li>
      <li class="icon-slash_fill"><a href="/v6.1/network/vpc/manual/ipv4_ipv6" data-url="/v6.1/network/vpc/manual/ipv4_ipv6">IPv4/IPv6 双栈网络</a></li>
      <li class="icon-slash_fill"><a href="/v6.1/network/vpc/manual/ipv4_ipv6/ipv6_auto_cfg" data-url="/v6.1/network/vpc/manual/ipv4_ipv6/ipv6_auto_cfg">开启云服务器 IPv6 自动化配置</a></li></ul><div class="post-wrapper"><div class="post">
  <h1 class="post-title">
    开启云服务器 IPv6 自动化配置</h1>
  <div class="post-info">
    <div class="post-date">
      更新时间：2024-03-07 19:06:53
    </div>
    
    
    
    
    
    
    
      <div
        class="tag post-tag export-pdf has-tooltip-top has-tooltip-arrow"
        data-tooltip="下载范围：所属一级目录的全部内容"
        data-url="/v6.1/network/vpc/manual">
        <span class="icon-format_pdf_2_fill"></span>
        PDF
      </div>
      
    
  </div><div class="post-menu">
  <div class="post-menu-title">本页目录</div>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#_操作要点">操作要点</a></li>
    <li><a href="#_操作步骤">操作步骤</a>
      <ul>
        <li><a href="#_centos_7_5_配置示例">Centos 7.5 配置示例</a></li>
        <li><a href="#_ubuntu_18_04_配置示例">Ubuntu 18.04 配置示例</a></li>
        <li><a href="#_ubuntu_16_04_配置示例">Ubuntu 16.04 配置示例</a></li>
        <li><a href="#_windows_server_200820122016_配置示例">Windows Server 2008/2012/2016 配置示例</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div><div class="post-content">
    
      
      
<div class="paragraph">
<p>对于使用<strong>不支持 IPv6</strong> 的镜像所启动的云服务器，因未针对 DHCPv6 进行配置，云服务器的网络接口将无法自动获取和识别 IPv6 相关网络配置，因此，需要通过对云服务器进行手动配置来使云服务器支持 DHCPv6。</p>
</div>
<div class="sect1">
<h2 id="_操作要点">操作要点</h2>
<div class="sectionbody">
<div class="paragraph">
<p>云服务器内要配置支持 DHCPv6，主要包括四个要点：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>需要配置 <a href="https://en.wikipedia.org/wiki/DHCPv6#DHCP_Unique_Identifier">DUID</a> 的类型为 <a href="https://tools.ietf.org/html/rfc3315#section-9.2">DUID-LLT</a>。</p>
</li>
<li>
<p>需要在关闭网络时，及时清理 lease 文件，确保切换网络时 DUID 不会缓存在 lease 文件里。</p>
</li>
<li>
<p>需要关闭 DAD。<a href="https://tools.ietf.org/html/rfc4429">DAD</a> 功能会避免 IPv6 地址重复分配。因系统会通过 DHCP 机制避免地址重复分配，且底层有对 IPv6 实现地址代答功能，可能会导致云服务器内 IPv6 地址变为 <code>duplicated</code>，所以需要关闭 DAD。</p>
</li>
<li>
<p>配置完成后，需要重启云服务器，以确保您的配置生效。</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_操作步骤">操作步骤</h2>
<div class="sectionbody">
<div class="paragraph">
<p>不同操作系统、不同发行版的配置方法是不同的，需要根据您的操作系统版本和网络管理工具，并查阅相关文档，进行合理正确配置。下文为几种操作系统配置示例。</p>
</div>
<div class="sect2">
<h3 id="_centos_7_5_配置示例">Centos 7.5 配置示例</h3>
<div class="paragraph">
<p>以下操作基于镜像：<code>CentOS 7.5 64bit</code>。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>以 root 用户登录云服务器。</p>
</li>
<li>
<p>执行以下命令，检查 NetworkManager 版本，确保版本在 1.12 版本以上，才可支持 <code>dhcp-duid</code> 配置。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">NetworkManager --version</code></pre>
</div>
</div>
</li>
<li>
<p>若版本低于 1.12，执行以下命令，升级版本。</p>
<table class="tableblock frame-all grid-all stretch admon note">
<colgroup>
<col style="width: 100%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>该操作需确保云服务器能够连接公网。</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">yum update NetworkManager</code></pre>
</div>
</div>
</li>
<li>
<p>配置 DUID 的类型为 DUID-LLT。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>进入配置文件 <code>/etc/NetworkManager/NetworkManager.conf</code>。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/NetworkManager/NetworkManager.conf</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>i</strong> 切换至编辑模式，在配置文件中添加如下配置。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">[connection]
ipv6.dhcp-duid=llt</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>ESC</strong> 退出编辑模式，执行 <code>:wq</code> 保存并退出文件。</p>
</li>
</ol>
</div>
</li>
<li>
<p>修改网卡配置。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>进入网卡 <code>ifcfg-eth0</code> 的配置文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/sysconfig/network-scripts/ifcfg-eth0</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>i</strong> 切换至编辑模式，配置为如下内容。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">TYPE=Ethernet
NAME=eth0
DEVICE=eth0
BOOTPROTO=dhcp
ONBOOT=yes
IPV6INIT=yes
IPV6_AUTOCONF=no
IPV6_FAILURE_FATAL=no
DHCPV6C=yes</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>ESC</strong> 退出编辑模式，执行 <code>:wq</code> 保存并退出文件。</p>
</li>
</ol>
</div>
</li>
<li>
<p>配置 down hook，清理 DCHPv6 的 lease，避免切换网络时，DUID 还包含老的 MAC 信息。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>新建并进入 down hook 配置文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/NetworkManager/dispatcher.d/dhclient-down-hooks.sh</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>i</strong> 切换至编辑模式，添加如下脚本配置。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#!/bin/sh
RUN=&#34;yes&#34;
if [ &#34;${RUN}&#34; != &#34;yes&#34; ]; then
exit 0
fi

if [ &#34;${NM_DISPATCHER_ACTION}&#34; != &#34;down&#34; ]; then
        exit 0
fi

interface=${DEVICE_IFACE}

f_leases=&#34;/var/lib/NetworkManager/dhclient*-${interface}.lease&#34;

rm -f ${f_leases};</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>ESC</strong> 退出编辑模式，执行 <code>:wq</code> 保存并退出文件。</p>
</li>
<li>
<p>为脚本赋予执行权限。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">chmod u+x /etc/NetworkManager/dispatcher.d/dhclient-down-hooks.sh</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>关闭 DAD。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>进入系统配置文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/sysctl.conf</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>i</strong> 切换至编辑模式，添加如下配置。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">net.ipv6.conf.eth0.accept_dad = 0
net.ipv6.conf.eth0.accept_ra = 1
net.ipv6.conf.eth0.accept_ra_defrtr = 1
net.ipv6.conf.eth0.accept_ra_rtr_pref = 1
net.ipv6.conf.eth0.accept_ra_rt_info_max_plen = 1</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>ESC</strong> 退出编辑模式，执行 <code>:wq</code> 保存并退出文件。</p>
</li>
</ol>
</div>
</li>
<li>
<p>在云服务器列表，右键点击云服务器，选择<strong>重启</strong>，重启云服务器，使配置生效。</p>
<table class="tableblock frame-all grid-all stretch admon note">
<colgroup>
<col style="width: 100%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>若重启后，云服务器仍未获取到 IPv6 地址，请登录云服务器，执行 <code>dhclient -6</code> 手动获取。</p>
</div></div></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_ubuntu_18_04_配置示例">Ubuntu 18.04 配置示例</h3>
<div class="paragraph">
<p>以下操作基于镜像：<code>Ubuntu Server 18.04.3 LTS 64bit</code>。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>以 ubuntu 用户登录云服务器。</p>
</li>
<li>
<p>执行以下命令，输入 ubuntu 用户密码，切换到 root 用户。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">sudo -i</code></pre>
</div>
</div>
</li>
<li>
<p>执行以下命令，安装 ifupdown，使用 networking 来管理网络。</p>
<table class="tableblock frame-all grid-all stretch admon note">
<colgroup>
<col style="width: 100%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>该操作需确保云服务器能够连接公网。</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">apt-get update
apt-get install ifupdown -y</code></pre>
</div>
</div>
</li>
<li>
<p>执行以下命令，禁用 netplan、systemd-networkd、networkd-dispatcher。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">echo &gt; /etc/netplan/50-cloud-init.yaml
systemctl disable systemd-networkd
systemctl disable networkd-dispatcher</code></pre>
</div>
</div>
</li>
<li>
<p>修改网卡配置，配置 <code>allow-hotplug</code>。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>执行如下命令，进入配置文件 <code>interfaces</code>。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vi /etc/network/interfaces</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>i</strong> 切换至编辑模式，添加如下配置。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">source /etc/network/interfaces.d/*.cfg

auto lo
iface lo inet loopback</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>ESC</strong> 退出编辑模式，执行 <code>:wq</code> 保存并退出文件。</p>
</li>
<li>
<p>执行如下命令，添加需要在 <code>interfaces</code> 配置中引用的第一个源文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/network/interfaces.d/50-cloud-init.cfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>文件配置如下：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">allow-hotplug eth0
iface eth0 inet dhcp</code></pre>
</div>
</div>
</li>
<li>
<p>执行如下命令，添加需要在 <code>interfaces</code> 配置中引用的第二个源文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/network/interfaces.d/60-default-with-ipv6.cfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>文件配置如下：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">iface eth0 inet6 dhcp
   autoconf 0</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>配置 down hook，清理 DHCPv6 的 lease，避免切换网络时，DUID 还包含老的 MAC 信息。</p>
<div class="paragraph">
<p>dhclient 会把 DHCPv4 和 DHCPv6 的配置互做备份来确保使用相同的 DUID，所以 DHCPv4 和 DHCPv6 的 lease 都需要删除。</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>新建并进入 down hook 配置文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/network/if-post-down.d/lease_clean</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>i</strong> 切换至编辑模式，添加如下脚本配置。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#!/bin/sh

f6_leases=&#34;/var/lib/dhcp/dhclient6.${IFACE}.leases&#34;
f4_leases=&#34;/var/lib/dhcp/dhclient.${IFACE}.leases&#34;

if [ -e ${f6_leases} ]; then
		rm -f ${f6_leases};
fi

if [ -e ${f4_leases} ]; then
		rm -f ${f4_leases};
fi</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>ESC</strong> 退出编辑模式，执行 <code>:wq</code> 保存并退出文件。</p>
</li>
<li>
<p>为脚本赋予执行权限。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">chmod u+x chmod u+x /etc/network/if-post-down.d/lease_clean</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>关闭 DAD。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>进入系统配置文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/sysctl.conf</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>i</strong> 切换至编辑模式，添加如下配置。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">net.ipv6.conf.eth0.accept_dad = 0</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>ESC</strong> 退出编辑模式，执行 <code>:wq</code> 保存并退出文件。</p>
</li>
</ol>
</div>
</li>
<li>
<p>在云服务器列表，右键点击云服务器，选择<strong>重启</strong>，重启云服务器，使配置生效。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_ubuntu_16_04_配置示例">Ubuntu 16.04 配置示例</h3>
<div class="paragraph">
<p>以下操作基于镜像：<code>Ubuntu Server 16.04.5 LTS 64bit</code>。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>以 ubuntu 用户登录云服务器。</p>
</li>
<li>
<p>执行以下命令，输入 ubuntu 用户密码，切换到 root 用户。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">sudo -i</code></pre>
</div>
</div>
</li>
<li>
<p>修改网卡配置，配置 <code>allow-hotplug</code>。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>执行如下命令，进入配置文件 <code>interfaces</code>。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/network/interfaces</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>i</strong> 切换至编辑模式，配置为如下内容。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">source /etc/network/interfaces.d/*.cfg

auto lo
iface lo inet loopback</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>ESC</strong> 退出编辑模式，执行 <code>:wq</code> 保存并退出文件。</p>
</li>
<li>
<p>执行如下命令，添加需要在 <code>interfaces</code> 配置中引用的第一个源文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/network/interfaces.d/50-cloud-init.cfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>文件配置如下：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">allow-hotplug eth0
iface eth0 inet dhcp</code></pre>
</div>
</div>
</li>
<li>
<p>执行如下命令，添加需要在 <code>interfaces</code> 配置中引用的第二个源文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/network/interfaces.d/60-default-with-ipv6.cfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>文件配置如下：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">iface eth0 inet6 dhcp
   autoconf 0</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>配置 down hook，清理 DHCPv6 的 lease，避免切换网络时，DUID 还包含老的 MAC 信息。</p>
<div class="paragraph">
<p>dhclient 会把 DHCPv4 和 DHCPv6 的配置互做备份来确保使用相同的 DUID，所以 DHCPv4 和 DHCPv6 的 lease 都需要删除。</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>新建并进入 down hook 配置文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/network/if-post-down.d/lease_clean</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>i</strong> 切换至编辑模式，添加如下脚本配置。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#!/bin/sh

f6_leases=&#34;/var/lib/dhcp/dhclient6.${IFACE}.leases&#34;
f4_leases=&#34;/var/lib/dhcp/dhclient.${IFACE}.leases&#34;

if [ -e ${f6_leases} ]; then
		rm -f ${f6_leases};
fi

if [ -e ${f4_leases} ]; then
		rm -f ${f4_leases};
fi</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>ESC</strong> 退出编辑模式，执行 <code>:wq</code> 保存并退出文件。</p>
</li>
<li>
<p>为脚本赋予执行权限。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">chmod u+x /etc/network/if-post-down.d/lease_clean</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>关闭 DAD。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>进入系统配置文件。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi /etc/sysctl.conf</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>i</strong> 切换至编辑模式，添加如下配置。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">net.ipv6.conf.eth0.accept_dad = 0</code></pre>
</div>
</div>
</li>
<li>
<p>按 <strong>ESC</strong> 退出编辑模式，执行 <code>:wq</code> 保存并退出文件。</p>
</li>
</ol>
</div>
</li>
<li>
<p>在云服务器列表，右键点击云服务器，选择<strong>重启</strong>，重启云服务器，使配置生效。</p>
<table class="tableblock frame-all grid-all stretch admon note">
<colgroup>
<col style="width: 100%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>若重启后，云服务器仍未获取到 IPv6 地址，请登录云服务器，执行 <code>dhclient -6</code> 手动获取。</p>
</div></div></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_windows_server_200820122016_配置示例">Windows Server 2008/2012/2016 配置示例</h3>
<div class="paragraph">
<p>Windows Server 默认开启 IPv6 协议与 DHCPv6，但 DHCPv6 的相关配置需要与<a href="#_操作要点">操作要点</a>所述保持一致。</p>
</div>
<div class="paragraph">
<p>以下操作基于镜像：<code>Windows Server 2016 简体中文 企业版 64位</code>，其他系统配置方法类似。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>登录云服务器。</p>
</li>
<li>
<p>以管理员身份启动 cmd 命令提示符窗口，执行以下命令，禁用 IPv6 随机标识。</p>
<div class="paragraph">
<p>云服务器网卡默认都会有一个链路本地（Link Local）IPv6 地址，Windows Server 默认的 Link Local IPv6 地址生成方式是随机生成的，这与基于 MAC-48 的 <a href="https://tools.ietf.org/html/rfc4291#appendix-A">EUI-64</a> 的方式不同，所以需要禁用 Link Local IPv6 地址随机生成。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">netsh interface ipv6 set global randomizeidentifiers=disabled</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/cloud_service/network/eip/inbind_ipv6_11.png" alt="inbind ipv6 11"/>
</div>
</div>
</li>
<li>
<p>将双栈接口 <strong>dadtransmits</strong> 修改成 <code>0</code>。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>执行如下命令，查看接口列表和双栈接口的 ID。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">netsh interface ipv6 show interfaces</code></pre>
</div>
</div>
<div class="paragraph">
<p>显示如下信息：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Idx     Met         MTU          状态                名称
---  ----------  ----------  ------------  ---------------------------
  1          75  4294967295  connected     Loopback Pseudo-Interface 1
  9          75        1280  disconnected  isatap.{2B8B139B-418D-4593-A2DC-4F43D31A1833}
  6          75        1280  connected     Teredo Tunneling Pseudo-Interface
  5           5        1500  disconnected  以太网 2

netsh interface ipv6&gt;set interface 5 dadtransmits=0
确定。</pre>
</div>
</div>
<div class="paragraph">
<p>如上所示，本示例中的双栈接口的 ID 为 <code>5</code>。</p>
</div>
</li>
<li>
<p>执行以下命令，将双栈接口的 <strong>dadtransmits</strong> 修改成 <code>0</code>。</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">netsh interface ipv6 set interface &lt;Interfase_ID&gt; dadtransmits=0</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch admon note">
<colgroup>
<col style="width: 100%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>命令中 <code>&lt;Interfase_ID&gt;</code> 表示双栈接口 ID，本示例为 5，请根据您的实际情况进行替换。</p>
</div></div></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</li>
<li>
<p>修改注册表 <strong>TCPip6</strong> &gt; <strong>Parameters</strong> 下的 <strong>Dhcpv6DUID</strong>。</p>
<div class="paragraph">
<p>部分 Windows Server 中的 <strong>Dhcpv6DUID</strong> 为固定值，会导致 Windows Server DHCP 冲突，所以需要修改 <strong>Dhcpv6DUID</strong> 为独特值，最方便的方式就是把最后 48 位修改为云服务器的 MAC 地址。</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>在 cmd 命令行窗口中，执行 <code>regedit</code> 命令打开注册表编辑器，并打开注册表目录 <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\TCPIP6\Parameters</code>。</p>
<div class="imageblock">
<div class="content">
<img src="/images/cloud_service/network/eip/IPv6_dualstack_ip_windows_1.png" alt="IPv6 dualstack ip windows 1"/>
</div>
</div>
</li>
<li>
<p>右键点击 <strong>Dhcpv6DUID</strong>，修改 <strong>Dhcpv6DUID</strong> 最后的 12 个字符修改为接口的 MAC 地址。</p>
<div class="imageblock">
<div class="content">
<img src="/images/cloud_service/network/eip/IPv6_dualstack_ip_windows_2.png" alt="IPv6 dualstack ip windows 2"/>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>重启网络适配器获取 IPv6 地址。</p>
<div class="paragraph">
<p>进入网络连接配置页面，点击网络接口，然后点击<strong>禁用此网络设备</strong>，禁用成功后再点击<strong>启用此网络设备</strong>。启用成功后，网络接口便可成功获取到 IPv6 地址。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/cloud_service/network/eip/IPv6_dualstack_ip_windows_3.png" alt="IPv6 dualstack ip windows 3"/>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>

    

  </div>
  <div class="post-footer">
    <div class="post-prev">
    </div>
    <div class="post-next">
    </div>
  </div>
  <div class="post-back-to-top">
    <span class="icon-up_3_fill"></span>
  </div>
</div>
<div class="post-placeholder"><div class="post-menu">
  <div class="post-menu-title">本页目录</div>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#_操作要点">操作要点</a></li>
    <li><a href="#_操作步骤">操作步骤</a>
      <ul>
        <li><a href="#_centos_7_5_配置示例">Centos 7.5 配置示例</a></li>
        <li><a href="#_ubuntu_18_04_配置示例">Ubuntu 18.04 配置示例</a></li>
        <li><a href="#_ubuntu_16_04_配置示例">Ubuntu 16.04 配置示例</a></li>
        <li><a href="#_windows_server_200820122016_配置示例">Windows Server 2008/2012/2016 配置示例</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div></div>
      </div>
    </div>
  </div>
</div></div>
    </body><script src="/js/bootstrap.min.js"></script>
<script src="/js/autocomplete/jquery.autocomplete.js"></script>
<script src="/js/copy-to-clipboard.js"></script>
<script src="/js/highlight.min.js"></script>
<script src="/js/jquery.tmpl.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/search/jquery.mark.min.js"></script>

<script type="text/javascript" src="/js/common.428b8a7f426567136e0501d49705f10dac2e4539d10c2f396d7c9ee45df1469eaa38e983928589e0e35ed30c1732ddbcda694ac0928ffffffee76b4a0017adf2.js" integrity="sha512-QouKf0JlZxNuBQHUlwXxDawuRTnRDC85bXye5F3xRp6qOOmDkoWJ4ONe0wwXMt282mlKwJKP///&#43;52tKABet8g=="></script>

<script type="text/javascript" src="/js/search.d8001c3e1b66b9a0b48e0c23ad0dbfc0906f194f8925ae78a9900b960679cfa7e41cebd9efd654f84535d02cbce7c4971f226e6f07288c26c3c4560c36d7655b.js"></script>
<script>
  $(function() {
    
    hljs.highlightAll();
    
    $.each($('.post-content .imageblock img'), function () {
      $(this).attr('data-mfp-src', $(this).attr('src'));
    });
    $('.post-content').magnificPopup({
      disableOn: function () {
        if ($(window).width() < 600) {
          return false;
        }
        return true;
      },
      delegate: '.imageblock img',
      type: 'image',
      gallery: {
        enabled: true,
      },
    });
  });
</script>
</html>
