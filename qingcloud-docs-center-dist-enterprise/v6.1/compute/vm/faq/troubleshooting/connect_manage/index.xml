<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>连接管理 on 用户指南</title>
    <link>/v6.1/compute/vm/faq/troubleshooting/connect_manage/</link>
    <description>Recent content in 连接管理 on 用户指南</description>
    <generator>Hugo -- gohugo.io</generator>
    <copyright>©2022 QingCloud, Inc. All rights reserved</copyright><atom:link href="/v6.1/compute/vm/faq/troubleshooting/connect_manage/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ssh 连接基本问题排查</title>
      <link>/v6.1/compute/vm/faq/troubleshooting/connect_manage/ssh_problems/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/v6.1/compute/vm/faq/troubleshooting/connect_manage/ssh_problems/</guid>
      <description>背景信息 ssh 远程登入连接不上，提示连接拒绝相关提示，初步定位是由于 sshd 端口不通导致，以下是故障定位流程，请参考。
操作步骤 排查 SSH 服务状态 登录云服务器，执行命令查看 ssh 服务是否正常启动。
systemctl status sshd 如果服务正常启动，则直接执行命令查看 ssh 监听的端口。
netstat -anp|grep sshd 如果服务没有正常启动，先执行命令启动 ssh 服务，再查看 ssh 监听的端口。
systemctl start sshd 检查 iptables 配置是否异常 使用 WEB vnc 登入到云服务器中，执行命令，查看防火墙规则。
iptables -nvL 若之前已设置过规则策略，执行命令，将原有的 iptables 文件保存一份，避免之前设置策略丢失。
cp -a /etc/sysconfig/iptables /etc/sysconfig/iptables.bak 再执行命令，清空服务器上所有的规则。
iptables -F 检查云平台防火墙规则是否异常 检查云服务器绑定防火墙中下行规则 ICMP 协议是否启动添加，ssh 服务端口是否添加放行。
若通过 VPC 端口转发的 SSH 服务，则需要检查端口转发中设置源端口，是否在 VPC 绑定的安全组下行规则中有添加放行，另外是否配置了源 IP，如果配置了，可以取消源 IP 限制测试。
检查绑定公网 IP 方式，如绑定为内网绑定模式，则需要删除该 IP，重新申请外部绑定模式公网 IP。无特殊需求建议使用外部绑定模式，内部绑定模式需云服务器内自行设置网卡配置。
检查本地终端是否异常 先排查本地终端是否设置了防火墙规则，比如限制了公网访问；</description>
    </item>
    
    <item>
      <title>ssh 密钥登录云服务器提示未注册</title>
      <link>/v6.1/compute/vm/faq/troubleshooting/connect_manage/troubleshooting_process_of_ssh_login_exception/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/v6.1/compute/vm/faq/troubleshooting/connect_manage/troubleshooting_process_of_ssh_login_exception/</guid>
      <description>问题现象 ssh 使用密码远程的时候正常，ssh 秘钥登录提示未注册，centos7.5 的云服务器。
排查步骤 检查 /etc/ssh/sshd_config 和 /etc/ssh/ssh_config 的配置，与正常的云服务器做对比 egrep -v “#^$” /etc/ssh/sshd_config ，并没有发现异常
检查了.ssh 目录权限和 authorized_keys 文件权限，一般 .ssh 目录的权限为 700 或者 755 authorized_keys 的文件权限为 600 或者 644，没有发现异常
检查了防火墙以及 /etc/hosts.deny /etc/hosts.allow 有没有配置黑名单，并没有异常
清空 know_hosts 的内容，还是不行
开启了的 debug，有以下内容
debug1: kex_input_ext_info: server-sig-algs=&amp;lt;rsa-sha2-256,rsa-sha2-512&amp;gt; debug3: receive packet: type 6 debug2: service_accept: ssh-userauth debug1: SSH2_MSG_SERVICE_ACCEPT received debug3: send packet: type 50 debug3: receive packet: type 51 debug1: Authentications that can continue: publickey debug3: start over, passed a different list publickey debug3: preferred gssapi-keyex,gssapi-with-mic,publickey,keyboard-interactive,password debug3: authmethod_lookup publickey debug3: remaining preferred: keyboard-interactive,password debug3: authmethod_is_enabled publickey debug1: Next authentication method: publickey debug1: Trying private key: /root/kp-89l1y95c systemctl sshd status 的时候发现了一个报错</description>
    </item>
    
    <item>
      <title>如何通过 ssh 密钥方式访问云服务器</title>
      <link>/v6.1/compute/vm/faq/troubleshooting/connect_manage/ssh_key/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/v6.1/compute/vm/faq/troubleshooting/connect_manage/ssh_key/</guid>
      <description>前提条件 登录管理控制台，选择 产品与服务 &amp;gt; 计算 &amp;gt; 云服务器，进入云服务器列表页面。
在左侧的 计算基础服务 导航栏，选择 计算 &amp;gt; SSH 密钥里面创建一个 SSH 密钥， 然后加载到你的云服务器上并下载私钥文件（例如 kp-1234abcd ）。
说明 在进行 SSH 连接之前，请确保在云服务器对应的防火墙下行规则中打开 TCP 22 号端口的访问。
操作步骤 Linux 系统下，使用下面的命令登录 # chmod 600 /path/to/kp-1234abcd # ssh -i /path/to/kp-1234abcd root@ip_address Windows 系统下用 putty 登录 很多 Windows 桌面用户都会使用著名的 PuTTY 作为 SSH 客户端来登录远程的 Linux 云服务器，但是 PuTTY 不支持 OpenSSH 的密钥格式，而是使用它自己的密钥格式。因此，PuTTY 提供了一个名为 “puttygen” 的密钥格式转换工具。
首先下载 putty 和 puttygen：
http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html
转换密钥格式
启动 puttygen，点击 +Conversions &amp;gt; Import key，选中您在云平台中创建并下载的 SSH 密钥，文件名形如 kp-1234abcd。然后点击 Save private key，您将得到 PuTTY 格式的私钥，如 kp-1234abcd.</description>
    </item>
    
    <item>
      <title>云服务器的远程连接的默认登录用户名和密码</title>
      <link>/v6.1/compute/vm/faq/troubleshooting/connect_manage/default_user_pwd/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/v6.1/compute/vm/faq/troubleshooting/connect_manage/default_user_pwd/</guid>
      <description>在云服务器对应的镜像详情页中可以找到默认的用户名和密码。</description>
    </item>
    
    <item>
      <title>root 用户通过 ssh 登录 Linux 实例报 “Permission denied, please try again”</title>
      <link>/v6.1/compute/vm/faq/troubleshooting/connect_manage/root_login_permission_denie/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/v6.1/compute/vm/faq/troubleshooting/connect_manage/root_login_permission_denie/</guid>
      <description>概述 使用 root 用户通过 SSH 登录 Linux 实例时，报 “Permission denied, please try again” 错误。本文主要介绍如何解决该问题。
背景信息 当使用 SSH 登录 Linux 系统的云服务器时，如果是 root 用户，即便输入了正确的密码，也会出现类似如下的错误信息。
说明 非root用户可以正常登录，而且root用户通过 管理终端可以正常登录。
Permission denied, please try again.
SSH 服务器拒绝了密码，请再试一次。
请检查 secure 日志，若包含如下错误信息，则该问题通常是由于系统启用了 SELinux 服务所致。请参考 SELinux 服务引起问题的解决方法。其他情况请参考 禁止 root 用户登录引起问题的解决方法。
error: Could not get shadow infromation for root. 解决方法 禁止 root 用户登录引起问题的解决方法 说明 本文相关 Linux 配置及说明已在 CentOS 6.5 64 位操作系统中进行过测试。其它类型及版本操作系统配置可能有所差异，具体情况请参阅相应发行版的官方文档。
相关策略可以提高服务器的安全性。请用户基于安全性和易用性权衡后，再确定是否需要修改相关配置。
请参考如下步骤，检查配置并修改。
通过 管理终端 登录 Linux 系统的云服务器。</description>
    </item>
    
    <item>
      <title>端口无法连接</title>
      <link>/v6.1/compute/vm/faq/troubleshooting/connect_manage/connectionrefused/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/v6.1/compute/vm/faq/troubleshooting/connect_manage/connectionrefused/</guid>
      <description>背景信息 访问端口失败，telnet 端口不通，服务无法连接。
操作步骤 查看云服务器服务端口是否正常启动，端口处于监听状态 以下均以常见的 80 端口为例：
通过 netstat 命令进行端口验证，如图：
未发现 80 端口处于监听状态，http 服务未启动，需先将 http 服务启动 启动完成后再次通过 netstat 进行验证
如上图标识行，80 端口处于 LISTEN 状态，表示端口处于活跃状态。
查看云服务器是否启用 iptables 或firewall，如启用是否端口不在放行规则 虚机镜像默认是未开启 iptables 规则和 firewall 规则，部分第三方软件（如docker,宝塔等）会自动将系统防火墙拉起来，并启用部分规则，导致部分应用端口被系统防火墙拦截。
iptables 规则查看：
firewall 规则查看
系统防火墙 iptables 和 firewall 相关服务启停命令及规则添加命令可参考：
https://www.cnblogs.com/zxg-blog/p/9835263.html
查看安全组规则是否添加 登录云平台，选择访问云服务器所属安全组：
查看安全组下行规则是否有 80 端口的放行规则
添加 80 端口下行规则并提交
点应用修改生效</description>
    </item>
    
    <item>
      <title>Linux 云服务器密钥登录下如何开启密码登录</title>
      <link>/v6.1/compute/vm/faq/troubleshooting/connect_manage/passwordauthentication/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/v6.1/compute/vm/faq/troubleshooting/connect_manage/passwordauthentication/</guid>
      <description> 操作背景 在绑定密钥时，未取消勾选 “加载 ssh 密钥以后，禁止密码登录”，同时需要通过用户名及密码登录。此时需要在云服务器内部开启密码登录。
操作步骤 以 CentOS 为例。
执行以下命令。
vi /etc/ssh/sshd_config 将配置文件中的 PasswordAuthentication 的参数改为 yes，然后执行以下命令重启 ssh 服务。
service ssh restart # 重启 ssh 服务； </description>
    </item>
    
  </channel>
</rss>
